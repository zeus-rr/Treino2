<!doctype html>
<html lang="pt-BR" class="dark">
<head>
    <link rel="icon" href="https://zeus-rr.github.io/treino/icon.png">
    <link rel="apple-touch-icon" href="https://zeus-rr.github.io/treino/icon.png">
    <link rel="shortcut icon" href="https://zeus-rr.github.io/treino/icon.png">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>SISTEMA DE TREINO PERSONALIZADO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class', 
            theme: { 
                extend: { 
                    colors: { 
                        'pink-hot': 'var(--primary-color, #FF1493)', 
                        'bg-dark': '#0b0f1a' 
                    } 
                } 
            }
        }
    </script>
    <style>
        :root { --primary-color: #FF1493; }
        .is-conjugated { margin-bottom: -1rem !important; border-bottom-left-radius: 0 !important; border-bottom-right-radius: 0 !important; border-bottom: 2px dashed var(--primary-color) !important; z-index: 10; }
        .is-conjugated + .workout-item { border-top-left-radius: 0 !important; border-top-right-radius: 0 !important; }
        .is-student-mode .admin-ui, .is-student-mode .edit-btn, .is-student-mode #btnTutorial, .is-student-mode .drag-handle { display: none !important; }
        .is-student-mode main { grid-template-columns: 1fr !important; }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: var(--primary-color); border-radius: 10px; }
        
        .category-content { display: none; }
        .category-content.active { display: block; animation: slideDown 0.3s ease-out; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        
        @media print { .no-print { display: none !important; } body { background: white !important; color: black !important; } }
        body { transition: background-color 0.3s ease, color 0.3s ease; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
        #tutorialModal, #adminModal { display: none; }
        #tutorialModal.active, #adminModal.active { display: flex; }
        .pink-bold { color: var(--primary-color) !important; font-weight: 900 !important; }
        .workout-item.dragging { opacity: 0.4; border: 2px dashed var(--primary-color); }
        .drag-handle { cursor: grab; padding: 0 10px; color: #64748b; font-size: 1.2rem; display: flex; align-items: center; }

        .btn-whatsapp-float { position: fixed; bottom: 20px; right: 20px; background-color: #25d366; color: white; padding: 12px 20px; border-radius: 50px; font-weight: 900; text-transform: uppercase; font-size: 11px; box-shadow: 0 10px 25px rgba(0,0,0,0.3); display: flex; align-items: center; gap: 8px; z-index: 1000; transition: all 0.3s ease; text-decoration: none; }
        
        .category-btn { transition: all 0.2s ease; border-left: 4px solid transparent; }
        .category-btn:hover { background: rgba(var(--primary-color), 0.05); border-left-color: var(--primary-color); }
    </style>
</head>
<body class="bg-slate-100 dark:bg-[#0b0f1a] text-slate-800 dark:text-slate-100 font-sans antialiased flex flex-col min-h-screen">

    <a id="waLink" href="#" target="_blank" class="btn-whatsapp-float no-print">
        <span>Falar com o Professor</span> üí¨
    </a>

    <div id="adminModal" class="fixed inset-0 z-[110] bg-slate-900/95 backdrop-blur-md p-4 items-center justify-center">
        <div class="bg-white dark:bg-slate-900 w-full max-w-md rounded-[2.5rem] shadow-2xl border border-slate-200 dark:border-slate-800 overflow-hidden">
            <div class="p-6 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center">
                <h2 class="text-xl font-black uppercase pink-bold">Configura√ß√µes Adm</h2>
                <button onclick="toggleAdmin()" class="text-slate-400 hover:text-red-500 font-bold text-2xl">&times;</button>
            </div>
            <div class="p-8 space-y-6">
                <div>
                    <label class="text-[10px] font-bold uppercase opacity-60 ml-2">Nome do Professor(a)</label>
                    <input type="text" id="profNameInput" class="w-full bg-slate-100 dark:bg-slate-800 p-4 rounded-2xl outline-none focus:ring-2 focus:ring-pink-hot font-bold">
                </div>
                <div>
                    <label class="text-[10px] font-bold uppercase opacity-60 ml-2">Cor do Sistema</label>
                    <div class="flex items-center gap-4 mt-2">
                        <input type="color" id="profColorInput" class="w-20 h-12 rounded-xl border-none cursor-pointer bg-transparent">
                        <span class="text-xs font-bold opacity-60">Toque para mudar a cor principal</span>
                    </div>
                </div>
                <div>
                    <label class="text-[10px] font-bold uppercase opacity-60 ml-2">PIN de Seguran√ßa (Atual)</label>
                    <input type="password" id="profPinInput" placeholder="Novo PIN" class="w-full bg-slate-100 dark:bg-slate-800 p-4 rounded-2xl outline-none focus:ring-2 focus:ring-pink-hot font-bold">
                </div>
                <button onclick="saveAdminData()" class="w-full bg-pink-hot text-white py-4 rounded-2xl font-black uppercase text-sm shadow-lg hover:scale-[1.02] transition-all">Salvar e Aplicar</button>
            </div>
        </div>
    </div>

    <div id="tutorialModal" class="fixed inset-0 z-[100] bg-slate-900/90 backdrop-blur-sm p-4 items-center justify-center">
        <div class="bg-white dark:bg-slate-900 w-full max-w-2xl rounded-[2.5rem] shadow-2xl border border-slate-200 dark:border-slate-800 overflow-hidden">
            <div class="p-6 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center">
                <h2 class="text-xl font-black uppercase pink-bold">Guia do Sistema</h2>
                <button onclick="toggleTutorial()" class="text-slate-400 hover:text-red-500 font-bold text-2xl">&times;</button>
            </div>
            <div class="p-8 space-y-4 text-sm">
                <p>‚Ä¢ <b>Admin:</b> Clique no seu nome no topo para acessar as configura√ß√µes (PIN padr√£o: 7118).</p>
                <p>‚Ä¢ <b>Cores:</b> A cor escolhida ser√° enviada no link para o aluno.</p>
                <p>‚Ä¢ <b>Seguran√ßa:</b> O sistema bloqueia c√≥pias n√£o autorizadas.</p>
            </div>
            <div class="p-6 text-center"><button onclick="toggleTutorial()" class="bg-pink-hot text-white px-8 py-3 rounded-full font-black uppercase text-xs">Entendido!</button></div>
        </div>
    </div>

    <header class="p-4 border-b border-slate-200 dark:border-slate-800 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <h1 id="brandName" class="text-xl italic uppercase tracking-tighter pink-bold cursor-pointer" onclick="toggleAdmin()">PERSONAL _ JAQUE</h1>
            <div class="flex items-center gap-3">
                <button onclick="toggleAdmin()" class="admin-ui bg-slate-100 dark:bg-slate-800 text-slate-500 p-2 rounded-xl border border-slate-200 dark:border-slate-700">‚öôÔ∏è</button>
                <button onclick="toggleTheme()" class="p-2 rounded-xl bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700">üåô</button>
            </div>
        </div>
    </header>

    <main class="max-w-[1600px] mx-auto p-4 grid grid-cols-1 lg:grid-cols-12 gap-6 flex-grow w-full">
        <aside class="lg:col-span-4 space-y-4 admin-ui">
            <div class="bg-white dark:bg-slate-900 p-6 rounded-[2rem] shadow-xl border border-slate-200 dark:border-slate-800">
                <input type="text" id="studentName" oninput="updateHeader()" placeholder="Nome do Aluno" class="w-full bg-slate-100 dark:bg-slate-800 p-3 rounded-xl outline-none focus:ring-2 focus:ring-pink-hot mb-3 font-bold">
                <select id="daySelector" class="w-full bg-slate-100 dark:bg-slate-800 p-3 rounded-xl font-bold text-sm">
                    <option value="segunda">Segunda-feira</option><option value="terca">Ter√ßa-feira</option><option value="quarta">Quarta-feira</option><option value="quinta">Quinta-feira</option><option value="sexta">Sexta-feira</option><option value="sabado">S√°bado</option>
                </select>
            </div>
            <div class="bg-white dark:bg-slate-900 p-6 rounded-[2rem] shadow-xl border border-slate-200 dark:border-slate-800">
                <h3 class="text-xs font-black uppercase mb-4 text-pink-hot">Exerc√≠cios</h3>
                <input type="text" id="searchEx" placeholder="Buscar..." class="w-full bg-slate-100 dark:bg-slate-800 p-3 rounded-xl mb-4 text-sm outline-none">
                <div id="accordionLib" class="space-y-2 max-h-[400px] overflow-y-auto custom-scrollbar"></div>
            </div>
        </aside>

        <section class="lg:col-span-8 space-y-6">
            <div class="flex flex-wrap gap-2 no-print">
                <button id="btnCopy" onclick="generateLink()" class="bg-pink-hot text-white px-5 py-3 rounded-full font-black text-[10px] uppercase shadow-lg admin-ui">Copiar Link do Aluno üîó</button>
                <button onclick="window.print()" class="bg-slate-700 text-white px-5 py-3 rounded-full font-black text-[10px] uppercase shadow-lg">Gerar PDF Aluno üìÑ</button>
            </div>
            <div id="studentDisplayHead" class="text-lg font-black pink-bold mb-4"></div>
            <div id="weekDisplay" class="space-y-10"></div>
            <textarea id="generalNotes" oninput="save()" class="w-full bg-white dark:bg-slate-900 p-6 rounded-[2rem] text-sm outline-none border border-slate-200 dark:border-slate-800 min-h-[120px]" placeholder="Observa√ß√µes do professor..."></textarea>
        </section>
    </main>

    <script>
        // --- CONFIGURA√á√ïES DE PROTE√á√ÉO ---
        const DOMINIO_AUTORIZADO = "zeus-rr.github.io"; // ALTERE PARA O SEU DOMINIO
        if (window.location.hostname !== DOMINIO_AUTORIZADO && window.location.hostname !== "localhost" && !window.location.search.includes('aluno=')) {
           // document.body.innerHTML = "<div style='color:white;text-align:center;padding:100px'><h1>ACESSO BLOQUEADO</h1><p>Sistema original de Personal Jaque.</p></div>";
        }

        // Bloqueio de Inspe√ß√£o
        document.addEventListener('contextmenu', e => e.preventDefault());
        document.onkeydown = e => { if(e.keyCode == 123 || (e.ctrlKey && e.shiftKey && e.keyCode == 73)) return false; };

        // --- L√ìGICA DO SISTEMA ---
        const exerciseLibrary = {
            "Peito": ["Supino Reto", "Supino Inclinado", "Crucifixo", "Peck Deck", "CrossOver"],
            "Costas": ["Puxada Frente", "Remada Baixa", "Remada Curvada", "Serrote", "PullDown"],
            "Pernas": ["Agachamento", "Leg Press", "Extensora", "Flexora", "Stiff", "Afundo"],
            "Bra√ßos": ["Rosca Direta", "Rosca Martelo", "Tr√≠ceps Pulley", "Tr√≠ceps Corda", "Testa"],
            "Ombros": ["Desenvolvimento", "Eleva√ß√£o Lateral", "Eleva√ß√£o Frontal", "Encolhimento"],
            "Cardio": ["Esteira", "Bicicleta", "Corda", "Burpee"]
        };

        let workoutData = { student: "", generalNotes: "", days: { segunda: [], terca: [], quarta: [], quinta: [], sexta: [], sabado: [] } };
        let adminSettings = { profName: "JAQUE", profColor: "#FF1493", adminPin: "7118" };

        function init() {
            const savedAdmin = localStorage.getItem('jaque_admin_final');
            if(savedAdmin) adminSettings = JSON.parse(savedAdmin);

            renderLibrary();
            
            const urlParams = new URLSearchParams(window.location.search);
            const alunoData = urlParams.get('aluno');
            
            if (alunoData) {
                try {
                    const decoded = JSON.parse(decodeURIComponent(atob(alunoData)));
                    workoutData = decoded;
                    document.body.classList.add('is-student-mode');
                    adminSettings.profName = urlParams.get('p') || "JAQUE";
                    adminSettings.profColor = "#" + (urlParams.get('c') || "FF1493");
                } catch(e) { loadFromStorage(); }
            } else { loadFromStorage(); }
            
            applyAdminSettings();
            render();
        }

        function applyAdminSettings() {
            document.getElementById('brandName').innerText = `PERSONAL _ ${adminSettings.profName.toUpperCase()}`;
            document.documentElement.style.setProperty('--primary-color', adminSettings.profColor);
            document.getElementById('profNameInput').value = adminSettings.profName;
            document.getElementById('profColorInput').value = adminSettings.profColor;
            document.getElementById('profPinInput').value = adminSettings.adminPin;
            
            const waLink = document.getElementById('waLink');
            waLink.style.backgroundColor = adminSettings.profColor;
            waLink.querySelector('span').innerText = `Falar com ${adminSettings.profName}`;
        }

        function toggleAdmin() {
            if(document.body.classList.contains('is-student-mode')) return;
            if(!document.getElementById('adminModal').classList.contains('active')) {
                const check = prompt("Digite o PIN de acesso:");
                if(check !== adminSettings.adminPin) return alert("PIN Incorreto!");
            }
            document.getElementById('adminModal').classList.toggle('active');
        }

        function saveAdminData() {
            adminSettings.profName = document.getElementById('profNameInput').value || "JAQUE";
            adminSettings.profColor = document.getElementById('profColorInput').value;
            adminSettings.adminPin = document.getElementById('profPinInput').value || "7118";
            localStorage.setItem('jaque_admin_final', JSON.stringify(adminSettings));
            applyAdminSettings();
            toggleAdmin();
        }

        function renderLibrary() {
            const container = document.getElementById('accordionLib');
            Object.keys(exerciseLibrary).forEach(cat => {
                let html = `<details class="bg-slate-50 dark:bg-slate-800/50 rounded-xl overflow-hidden mb-2">
                    <summary class="p-3 font-black text-[10px] uppercase cursor-pointer text-pink-hot">${cat}</summary>
                    <div class="p-2 space-y-1">
                        ${exerciseLibrary[cat].map(ex => `<div onclick="addEx('${ex}')" class="p-2 text-xs hover:bg-pink-hot hover:text-white rounded-lg cursor-pointer">${ex}</div>`).join('')}
                    </div></details>`;
                container.innerHTML += html;
            });
        }

        function render() {
            const container = document.getElementById('weekDisplay');
            container.innerHTML = "";
            const isStudent = document.body.classList.contains('is-student-mode');
            
            document.getElementById('studentDisplayHead').innerText = workoutData.student ? `ALUNO: ${workoutData.student}` : "";
            
            Object.keys(workoutData.days).forEach(day => {
                if(workoutData.days[day].length === 0) return;
                let html = `<div class="day-section"><h2 class="text-xl font-black pink-bold mb-4 uppercase italic"># ${day}</h2><div class="space-y-2">`;
                workoutData.days[day].forEach((ex, idx) => {
                    html += `<div class="workout-item bg-white dark:bg-slate-900 p-4 rounded-3xl border border-slate-200 dark:border-slate-800 flex justify-between items-center">
                        <div>
                            <div class="font-bold text-sm uppercase">${ex.n}</div>
                            <input type="text" value="${ex.obs}" oninput="workoutData.days['${day}'][${idx}].obs=this.value;save()" class="text-[10px] bg-transparent border-b border-dashed outline-none w-full" placeholder="Obs..." ${isStudent?'disabled':''}>
                        </div>
                        <div class="flex gap-2">
                            <input type="text" value="${ex.r}" oninput="workoutData.days['${day}'][${idx}].r=this.value;save()" class="w-12 text-center bg-slate-100 dark:bg-slate-800 rounded-lg text-xs p-1" ${isStudent?'disabled':''}>
                            ${!isStudent ? `<button onclick="removeEx('${day}',${idx})" class="text-red-500 text-xs">‚úï</button>` : ''}
                        </div>
                    </div>`;
                });
                html += `</div></div>`;
                container.innerHTML += html;
            });
        }

        function addEx(name) { 
            const day = document.getElementById('daySelector').value; 
            workoutData.days[day].push({n: name, r: "3x12", obs: ""}); 
            save(); render(); 
        }

        function removeEx(day, idx) { workoutData.days[day].splice(idx, 1); save(); render(); }

        function save() { 
            if(document.body.classList.contains('is-student-mode')) return;
            workoutData.student = document.getElementById('studentName').value;
            workoutData.generalNotes = document.getElementById('generalNotes').value;
            localStorage.setItem('jaque_data_final', JSON.stringify(workoutData)); 
        }

        function loadFromStorage() {
            const saved = localStorage.getItem('jaque_data_final');
            if(saved) workoutData = JSON.parse(saved);
        }

        function updateHeader() { updateHeader(); save(); }

        function generateLink() {
            const jsonStr = JSON.stringify(workoutData);
            const encoded = btoa(encodeURIComponent(jsonStr));
            const color = adminSettings.profColor.replace('#','');
            const url = `${window.location.origin}${window.location.pathname}?aluno=${encoded}&p=${encodeURIComponent(adminSettings.profName)}&c=${color}`;
            navigator.clipboard.writeText(url);
            alert("Link do Aluno Copiado com Sucesso!");
        }

        function toggleTheme() { document.documentElement.classList.toggle('dark'); }
        function toggleTutorial() { document.getElementById('tutorialModal').classList.toggle('active'); }

        window.onload = init;
    </script>
</body>
</html>
